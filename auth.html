<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Mate – Verifying</title>

  <style>
    body {
      margin: 0;
      height: 100vh;
      background: radial-gradient(circle at top, #0b1220, #02040a);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: white;
    }

    .card {
      text-align: center;
      padding: 48px 56px;
      border-radius: 16px;
      background: rgba(255,255,255,0.03);
      backdrop-filter: blur(12px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
    }

    .logo {
      width: 72px;
      margin-bottom: 24px;
    }

    .spinner {
      margin: 28px auto 0;
      width: 36px;
      height: 36px;
      border: 3px solid rgba(255,255,255,0.2);
      border-top: 3px solid #4f7cff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .small {
      opacity: 0.6;
      margin-top: 16px;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="card">
    <img src="/favicon.png" class="logo" />
    <h2 id="title">Verifying your account</h2>
    <p id="text">Opening My Mate…</p>
    <div class="spinner"></div>
<div class="small">You can close this window after login.</div>

<button onclick="openApp()" style="
  margin-top: 20px;
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  background: #4f7cff;
  color: white;
  font-size: 14px;
  cursor: pointer;
">
  Open My Mate
</button>

  </div>

<script>
  const hash = window.location.hash;

  function openApp() {
    console.log("OPENAPP CLICKED", {
      href: window.location.href,
      hash,
      target: "com.mymate.app://auth/callback" + hash,
    });

    window.location.href = "com.mymate.app://auth/callback" + hash;
  }

  if (hash && hash.includes("access_token")) {
    setTimeout(openApp, 300);

    setTimeout(() => {
      document.getElementById("title").innerText = "Account verified";
      document.getElementById("text").innerText = "Click the button if the app didn't open.";
      document.querySelector(".spinner").style.display = "none";
    }, 1200);
  } else {
    document.getElementById("title").innerText = "Link expired";
    document.getElementById("text").innerText = "Please request a new login email.";
  }
</script>


</body>
</html>
